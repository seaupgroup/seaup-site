<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Atomy HemoHIM - Register</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, "Noto Sans TC", "Noto Sans SC", "Microsoft JhengHei", sans-serif; background: #f8fafc; margin: 0; padding: 0; }
    .main { max-width: 440px; margin: 44px auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 16px #eee; padding: 28px; }
    .main h2 { color: #ea4a2b; margin-bottom: 16px; }
    .main label { font-weight: bold; display: block; margin-top: 17px; }
    select, button { width: 100%; font-size: 1em; margin-top: 7px; padding: 8px; border-radius: 8px; border: 1px solid #d4d4d4; }
    button { background: #ea4a2b; color: #fff; border: none; font-weight: bold; margin-top: 22px; cursor: pointer; transition: background 0.15s;}
    button:hover { background: #d5371b; }
    .msg { margin-top: 24px; color: #d5371b; font-weight: bold; min-height: 32px;}
    .lang-sel { text-align:right; margin-bottom: 6px;}
    .lang-sel select {width:auto;}
    .redeem { margin-top:32px; text-align:center; font-size:1em;}
    .redeem a { color:#ea4a2b; text-decoration:underline; }
  </style>
</head>
<body>
  <div class="main">
    <div class="lang-sel">
      <label style="font-size:1em;font-weight:bold;" for="uiLangSel">ğŸŒ</label>
      <select id="uiLangSel">
        <option value="en">English</option>
        <option value="zh_tw">ç¹é«”ä¸­æ–‡</option>
        <option value="zh_cn">ç®€ä½“ä¸­æ–‡</option>
        <option value="fr">FranÃ§ais</option>
        <option value="de">Deutsch</option>
        <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
        <option value="th">à¹„à¸—à¸¢</option>
        <option value="es">EspaÃ±ol</option>
        <option value="pt">PortuguÃªs</option>
        <option value="fil">Filipino</option>
        <option value="id">Bahasa Indonesia</option>
      </select>
    </div>
    <h2 id="ui_title">Atomy HemoHIM Member Registration</h2>
    <label for="regionInput" id="ui_region_label">Region</label>
    <select id="regionInput"></select>
    <label for="langInput" id="ui_lang_label">Language</label>
    <select id="langInput"></select>
    <button id="submitBtn" onclick="getCodeAndRedirect()">Get Member Number</button>
    <div id="msg" class="msg"></div>
    <div class="redeem">
      <a id="redeemLink" href="https://form.jotform.com/251414756620050" target="_blank">ä½å®¿åˆ¸å…Œæ›è¡¨å–® / Redeem Voucher</a>
    </div>
  </div>
  <script>
    // å¤šèªæ–‡æœ¬è¨­å®š
    const uiLangs = ["en","zh_tw","zh_cn","fr","de","ru","th","es","pt","fil","id"];
    const texts = {
      ui_title: {
        en: "Atomy HemoHIM Member Registration",
        zh_tw: "Atomy HemoHIM æœƒå“¡ç·¨è™Ÿé ˜å–",
        zh_cn: "Atomy HemoHIM ä¼šå‘˜ç¼–å·é¢†å–",
        fr: "Inscription Membre Atomy HemoHIM",
        de: "Atomy HemoHIM Mitgliederanmeldung",
        ru: "Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ° Atomy HemoHIM",
        th: "à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸±à¸šà¸£à¸«à¸±à¸ªà¸ªà¸¡à¸²à¸Šà¸´à¸ Atomy HemoHIM",
        es: "Registro de Miembro Atomy HemoHIM",
        pt: "Registro de Membro Atomy HemoHIM",
        fil: "Atomy HemoHIM Member Registration",
        id: "Pendaftaran Anggota Atomy HemoHIM"
      },
      ui_region_label: {
        en:"Region", zh_tw:"åœ°å€", zh_cn:"åœ°åŒº", fr:"RÃ©gion", de:"Region", ru:"Ğ ĞµĞ³Ğ¸Ğ¾Ğ½", th:"à¸ à¸¹à¸¡à¸´à¸ à¸²à¸„", es:"RegiÃ³n", pt:"RegiÃ£o", fil:"Rehiyon", id:"Wilayah"
      },
      ui_lang_label: {
        en:"Language", zh_tw:"èªè¨€", zh_cn:"è¯­è¨€", fr:"Langue", de:"Sprache", ru:"Ğ¯Ğ·Ñ‹Ğº", th:"à¸ à¸²à¸©à¸²", es:"Idioma", pt:"Idioma", fil:"Wika", id:"Bahasa"
      },
      submitBtn: {
        en:"Get Member Number", zh_tw:"é ˜å–æœƒå“¡ç·¨è™Ÿ", zh_cn:"é¢†å–ä¼šå‘˜ç¼–å·", fr:"Obtenir un numÃ©ro de membre", de:"Mitgliedsnummer erhalten", ru:"ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°", th:"à¸£à¸±à¸šà¸£à¸«à¸±à¸ªà¸ªà¸¡à¸²à¸Šà¸´à¸", es:"Obtener nÃºmero de miembro", pt:"Obter nÃºmero de membro", fil:"Kunin ang Member Number", id:"Dapatkan Nomor Anggota"
      },
      msg_choose: {
        en:"Please select region and language.",
        zh_tw:"è«‹é¸æ“‡åœ°å€èˆ‡èªè¨€ã€‚",
        zh_cn:"è¯·é€‰æ‹©åœ°åŒºä¸è¯­è¨€ã€‚",
        fr:"Veuillez choisir une rÃ©gion et une langue.",
        de:"Bitte wÃ¤hlen Sie Region und Sprache.",
        ru:"ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½ Ğ¸ ÑĞ·Ñ‹Ğº.",
        th:"à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸ à¸¹à¸¡à¸´à¸ à¸²à¸„à¹à¸¥à¸°à¸ à¸²à¸©à¸²",
        es:"Por favor seleccione regiÃ³n e idioma.",
        pt:"Por favor, selecione regiÃ£o e idioma.",
        fil:"Paki pili ng rehiyon at wika.",
        id:"Silakan pilih wilayah dan bahasa."
      },
      msg_wait: {
        en:"Please wait, assigning member number...",
        zh_tw:"è«‹ç¨å€™ï¼Œæ­£åœ¨åˆ†é…æœƒå“¡ç·¨è™Ÿ...",
        zh_cn:"è¯·ç¨å€™ï¼Œæ­£åœ¨åˆ†é…ä¼šå‘˜ç¼–å·...",
        fr:"Veuillez patienter, attribution du numÃ©ro...",
        de:"Bitte warten, Mitgliedsnummer wird zugewiesen...",
        ru:"ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ, Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚ÑÑ Ğ½Ğ¾Ğ¼ĞµÑ€ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°...",
        th:"à¸à¸£à¸¸à¸“à¸²à¸£à¸­à¸ªà¸±à¸à¸„à¸£à¸¹à¹ˆ à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸±à¸”à¸ªà¸£à¸£à¸£à¸«à¸±à¸ªà¸ªà¸¡à¸²à¸Šà¸´à¸...",
        es:"Espere mientras se asigna el nÃºmero...",
        pt:"Por favor, aguarde enquanto atribuÃ­mos o nÃºmero...",
        fil:"Sandali lang, ina-assign ang member number...",
        id:"Mohon tunggu, sedang menugaskan nomor anggota..."
      },
      msg_error: {
        en:"Error: ",
        zh_tw:"éŒ¯èª¤ï¼š",
        zh_cn:"é”™è¯¯ï¼š",
        fr:"ErreurÂ : ",
        de:"Fehler: ",
        ru:"ĞÑˆĞ¸Ğ±ĞºĞ°: ",
        th:"à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”: ",
        es:"Error: ",
        pt:"Erro: ",
        fil:"Error: ",
        id:"Kesalahan: "
      },
      msg_fail: {
        en:"API connection failed. Please try again.",
        zh_tw:"APIé€£ç·šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚",
        zh_cn:"APIè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚",
        fr:"Connexion API Ã©chouÃ©e. Veuillez rÃ©essayer.",
        de:"API-Verbindung fehlgeschlagen. Bitte versuchen Sie es erneut.",
        ru:"Ğ¡Ğ±Ğ¾Ğ¹ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ñ API. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.",
        th:"à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ API à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡",
        es:"ConexiÃ³n API fallida. IntÃ©ntelo de nuevo.",
        pt:"Falha na conexÃ£o API. Por favor, tente novamente.",
        fil:"API connection failed. Pakisubukan muli.",
        id:"Koneksi API gagal. Silakan coba lagi."
      }
    };

    // åœ°å€é¸å–®
    const regions = [
      {en:"Taiwan", zh_tw:"å°ç£", zh_cn:"å°æ¹¾", fr:"TaÃ¯wan", de:"Taiwan", ru:"Ğ¢Ğ°Ğ¹Ğ²Ğ°Ğ½ÑŒ", th:"à¹„à¸•à¹‰à¸«à¸§à¸±à¸™", es:"TaiwÃ¡n", pt:"Taiwan", fil:"Taiwan", id:"Taiwan"},
      {en:"Hong Kong", zh_tw:"é¦™æ¸¯", zh_cn:"é¦™æ¸¯", fr:"Hong Kong", de:"Hongkong", ru:"Ğ“Ğ¾Ğ½ĞºĞ¾Ğ½Ğ³", th:"à¸®à¹ˆà¸­à¸‡à¸à¸‡", es:"Hong Kong", pt:"Hong Kong", fil:"Hong Kong", id:"Hong Kong"},
      {en:"Singapore", zh_tw:"æ–°åŠ å¡", zh_cn:"æ–°åŠ å¡", fr:"Singapour", de:"Singapur", ru:"Ğ¡Ğ¸Ğ½Ğ³Ğ°Ğ¿ÑƒÑ€", th:"à¸ªà¸´à¸‡à¸„à¹‚à¸›à¸£à¹Œ", es:"Singapur", pt:"Singapura", fil:"Singapore", id:"Singapura"},
      {en:"Malaysia", zh_tw:"é¦¬ä¾†è¥¿äº", zh_cn:"é©¬æ¥è¥¿äºš", fr:"Malaisie", de:"Malaysia", ru:"ĞœĞ°Ğ»Ğ°Ğ¹Ğ·Ğ¸Ñ", th:"à¸¡à¸²à¹€à¸¥à¹€à¸‹à¸µà¸¢", es:"Malasia", pt:"MalÃ¡sia", fil:"Malaysia", id:"Malaysia"},
      {en:"Thailand", zh_tw:"æ³°åœ‹", zh_cn:"æ³°å›½", fr:"ThaÃ¯lande", de:"Thailand", ru:"Ğ¢Ğ°Ğ¸Ğ»Ğ°Ğ½Ğ´", th:"à¸›à¸£à¸°à¹€à¸—à¸¨à¹„à¸—à¸¢", es:"Tailandia", pt:"TailÃ¢ndia", fil:"Thailand", id:"Thailand"},
      {en:"France", zh_tw:"æ³•åœ‹", zh_cn:"æ³•å›½", fr:"France", de:"Frankreich", ru:"Ğ¤Ñ€Ğ°Ğ½Ñ†Ğ¸Ñ", th:"à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª", es:"Francia", pt:"FranÃ§a", fil:"France", id:"Perancis"},
      {en:"Germany", zh_tw:"å¾·åœ‹", zh_cn:"å¾·å›½", fr:"Allemagne", de:"Deutschland", ru:"Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ", th:"à¹€à¸¢à¸­à¸£à¸¡à¸™à¸µ", es:"Alemania", pt:"Alemanha", fil:"Germany", id:"Jerman"},
      {en:"Russia", zh_tw:"ä¿„ç¾…æ–¯", zh_cn:"ä¿„ç½—æ–¯", fr:"Russie", de:"Russland", ru:"Ğ Ğ¾ÑÑĞ¸Ñ", th:"à¸£à¸±à¸ªà¹€à¸‹à¸µà¸¢", es:"Rusia", pt:"RÃºssia", fil:"Russia", id:"Rusia"},
      {en:"Philippines", zh_tw:"è²å¾‹è³“", zh_cn:"è²å¾‹å®¾", fr:"Philippines", de:"Philippinen", ru:"Ğ¤Ğ¸Ğ»Ğ¸Ğ¿Ğ¿Ğ¸Ğ½Ñ‹", th:"à¸Ÿà¸´à¸¥à¸´à¸›à¸›à¸´à¸™à¸ªà¹Œ", es:"Filipinas", pt:"Filipinas", fil:"Pilipinas", id:"Filipina"},
      {en:"Indonesia", zh_tw:"å°å°¼", zh_cn:"å°å°¼", fr:"IndonÃ©sie", de:"Indonesien", ru:"Ğ˜Ğ½Ğ´Ğ¾Ğ½ĞµĞ·Ğ¸Ñ", th:"à¸­à¸´à¸™à¹‚à¸”à¸™à¸µà¹€à¸‹à¸µà¸¢", es:"Indonesia", pt:"IndonÃ©sia", fil:"Indonesia", id:"Indonesia"},
      {en:"Spain", zh_tw:"è¥¿ç­ç‰™", zh_cn:"è¥¿ç­ç‰™", fr:"Espagne", de:"Spanien", ru:"Ğ˜ÑĞ¿Ğ°Ğ½Ğ¸Ñ", th:"à¸ªà¹€à¸›à¸™", es:"EspaÃ±a", pt:"Espanha", fil:"Spain", id:"Spanyol"}
    ];

    // èªè¨€é¸å–®
    const langOptions = [
      {val:"en", label: {en:"English", zh_tw:"è‹±æ–‡", zh_cn:"è‹±è¯­", fr:"Anglais", de:"Englisch", ru:"ĞĞ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¸Ğ¹", th:"à¸­à¸±à¸‡à¸à¸¤à¸©", es:"InglÃ©s", pt:"InglÃªs", fil:"Ingles", id:"Inggris"}},
      {val:"zh_tw", label: {en:"Traditional Chinese", zh_tw:"ç¹é«”ä¸­æ–‡", zh_cn:"ç¹ä½“ä¸­æ–‡", fr:"Chinois traditionnel", de:"Traditionelles Chinesisch", ru:"Ğ¢Ñ€Ğ°Ğ´Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¸Ñ‚Ğ°Ğ¹ÑĞºĞ¸Ğ¹", th:"à¸ˆà¸µà¸™à¸•à¸±à¸§à¹€à¸•à¹‡à¸¡", es:"Chino tradicional", pt:"ChinÃªs tradicional", fil:"Tradisyonal na Chinese", id:"Chinese Tradisional"}},
      {val:"zh_cn", label: {en:"Simplified Chinese", zh_tw:"ç°¡é«”ä¸­æ–‡", zh_cn:"ç®€ä½“ä¸­æ–‡", fr:"Chinois simplifiÃ©", de:"Vereinfachtes Chinesisch", ru:"Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ ĞºĞ¸Ñ‚Ğ°Ğ¹ÑĞºĞ¸Ğ¹", th:"à¸ˆà¸µà¸™à¸•à¸±à¸§à¸¢à¹ˆà¸­", es:"Chino simplificado", pt:"ChinÃªs simplificado", fil:"Simplified Chinese", id:"Chinese Sederhana"}},
      {val:"fr", label: {en:"French", zh_tw:"æ³•æ–‡", zh_cn:"æ³•è¯­", fr:"FranÃ§ais", de:"FranzÃ¶sisch", ru:"Ğ¤Ñ€Ğ°Ğ½Ñ†ÑƒĞ·ÑĞºĞ¸Ğ¹", th:"à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª", es:"FrancÃ©s", pt:"FrancÃªs", fil:"Pranses", id:"Perancis"}},
      {val:"de", label: {en:"German", zh_tw:"å¾·æ–‡", zh_cn:"å¾·è¯­", fr:"Allemand", de:"Deutsch", ru:"ĞĞµĞ¼ĞµÑ†ĞºĞ¸Ğ¹", th:"à¹€à¸¢à¸­à¸£à¸¡à¸±à¸™", es:"AlemÃ¡n", pt:"AlemÃ£o", fil:"Aleman", id:"Jerman"}},
      {val:"ru", label: {en:"Russian", zh_tw:"ä¿„æ–‡", zh_cn:"ä¿„è¯­", fr:"Russe", de:"Russisch", ru:"Ğ ÑƒÑÑĞºĞ¸Ğ¹", th:"à¸£à¸±à¸ªà¹€à¸‹à¸µà¸¢", es:"Ruso", pt:"Russo", fil:"Ruso", id:"Rusia"}},
      {val:"th", label: {en:"Thai", zh_tw:"æ³°æ–‡", zh_cn:"æ³°è¯­", fr:"ThaÃ¯", de:"ThailÃ¤ndisch", ru:"Ğ¢Ğ°Ğ¹ÑĞºĞ¸Ğ¹", th:"à¹„à¸—à¸¢", es:"TailandÃ©s", pt:"TailandÃªs", fil:"Thai", id:"Thailand"}},
      {val:"es", label: {en:"Spanish", zh_tw:"è¥¿ç­ç‰™æ–‡", zh_cn:"è¥¿ç­ç‰™è¯­", fr:"Espagnol", de:"Spanisch", ru:"Ğ˜ÑĞ¿Ğ°Ğ½ÑĞºĞ¸Ğ¹", th:"à¸ªà¹€à¸›à¸™", es:"EspaÃ±ol", pt:"Espanhol", fil:"Espanyol", id:"Spanyol"}},
      {val:"pt", label: {en:"Portuguese", zh_tw:"è‘¡è„ç‰™æ–‡", zh_cn:"è‘¡è„ç‰™è¯­", fr:"Portugais", de:"Portugiesisch", ru:"ĞŸĞ¾Ñ€Ñ‚ÑƒĞ³Ğ°Ğ»ÑŒÑĞºĞ¸Ğ¹", th:"à¹‚à¸›à¸£à¸•à¸¸à¹€à¸à¸ª", es:"PortuguÃ©s", pt:"PortuguÃªs", fil:"Portuges", id:"Portugis"}},
      {val:"fil", label: {en:"Filipino", zh_tw:"è²å¾‹è³“æ–‡", zh_cn:"è²å¾‹å®¾è¯­", fr:"Philippin", de:"Filipino", ru:"Ğ¤Ğ¸Ğ»Ğ¸Ğ¿Ğ¿Ğ¸Ğ½ÑĞºĞ¸Ğ¹", th:"à¸Ÿà¸´à¸¥à¸´à¸›à¸›à¸´à¸™à¸ªà¹Œ", es:"Filipino", pt:"Filipino", fil:"Filipino", id:"Filipino"}},
      {val:"id", label: {en:"Bahasa Indonesia", zh_tw:"å°å°¼æ–‡", zh_cn:"å°å°¼è¯­", fr:"IndonÃ©sien", de:"Indonesisch", ru:"Ğ˜Ğ½Ğ´Ğ¾Ğ½ĞµĞ·Ğ¸Ğ¹ÑĞºĞ¸Ğ¹", th:"à¸­à¸´à¸™à¹‚à¸”à¸™à¸µà¹€à¸‹à¸µà¸¢", es:"Indonesio", pt:"IndonÃ©sio", fil:"Indonesian", id:"Bahasa Indonesia"}}
    ];

    // ---- é¸å–®åˆå§‹åŒ–èˆ‡èªè¨€åˆ‡æ› ----
    function setUILang(lang) {
      // æ¨™é¡Œèˆ‡æ¨™ç±¤
      document.getElementById('ui_title').textContent = texts.ui_title[lang];
      document.getElementById('ui_region_label').textContent = texts.ui_region_label[lang];
      document.getElementById('ui_lang_label').textContent = texts.ui_lang_label[lang];
      document.getElementById('submitBtn').textContent = texts.submitBtn[lang];

      // åœ°å€é¸å–®
      const rSel = document.getElementById('regionInput');
      rSel.innerHTML = '';
      regions.forEach(opt => {
        let o = document.createElement('option');
        o.value = opt.en;
        o.text = opt[lang] || opt.en;
        rSel.appendChild(o);
      });

      // èªè¨€é¸å–®
      const lSel = document.getElementById('langInput');
      lSel.innerHTML = '';
      langOptions.forEach(opt => {
        let o = document.createElement('option');
        o.value = opt.val;
        o.text = opt.label[lang];
        lSel.appendChild(o);
      });
    }

    // é é¢åˆå§‹è‡ªå‹•åˆ¤æ–·èªè¨€
    function detectBrowserLang() {
      let blang = (navigator.language || '').toLowerCase();
      if (blang.startsWith('zh') && blang.includes('tw')) return 'zh_tw';
      if (blang.startsWith('zh')) return 'zh_cn';
      if (blang.startsWith('fr')) return 'fr';
      if (blang.startsWith('de')) return 'de';
      if (blang.startsWith('ru')) return 'ru';
      if (blang.startsWith('th')) return 'th';
      if (blang.startsWith('es')) return 'es';
      if (blang.startsWith('pt')) return 'pt';
      if (blang.startsWith('fil') || blang.startsWith('tl')) return 'fil';
      if (blang.startsWith('id')) return 'id';
      return 'en';
    }

    // åˆå§‹åŒ–æµç¨‹
    window.addEventListener("DOMContentLoaded", function() {
      let uiLang = detectBrowserLang();
      document.getElementById('uiLangSel').value = uiLang;
      setUILang(uiLang);

      // èªè¨€é¸å–®åˆ‡æ›
      document.getElementById('uiLangSel').addEventListener('change', function() {
        setUILang(this.value);
      });
    });

    // ---- æäº¤åˆ†é…æœƒå“¡ç·¨è™Ÿï¼Œå°å‘ jotform ----
    async function getCodeAndRedirect() {
      const region = document.getElementById('regionInput').value;
      const lang = document.getElementById('langInput').value;
      const uiLang = document.getElementById('uiLangSel').value;
      const msgDiv = document.getElementById('msg');
      msgDiv.textContent = "";

      if (!region || !lang) {
        msgDiv.textContent = texts.msg_choose[uiLang];
        return;
      }
      msgDiv.textContent = texts.msg_wait[uiLang];
      try {
        const resp = await fetch('https://script.google.com/macros/s/AKfycbwatarqL8yQzmQpX9UBqxpiFs5RuqfvFgI7tOfqJKequkRs6SJ0tm2ayLRc9ur-oOYQ/exec', {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ action: "register", region: region, lang: lang })
        });
        const data = await resp.json();
        if (data.error) {
          msgDiv.textContent = texts.msg_error[uiLang] + data.error;
          return;
        }
        // çµ„æˆ JotForm é å¡«ç¶²å€
        const jotformUrl = `https://form.jotform.com/251412432618046?member_number=${encodeURIComponent(data.member_number)}&password=${encodeURIComponent(data.password)}&website=${encodeURIComponent(data.official_website)}&lang=${encodeURIComponent(lang)}`;
        window.location.href = jotformUrl;
      } catch(e) {
        msgDiv.textContent = texts.msg_fail[uiLang];
      }
    }
  </script>
</body>
</html>
