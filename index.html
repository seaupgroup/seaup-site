<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Atomy HemoHIM - Register</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, "Noto Sans TC", "Noto Sans SC", "Microsoft JhengHei", sans-serif; background: #f8fafc; margin: 0; padding: 0; }
    .main { max-width: 480px; margin: 44px auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 16px #eee; padding: 28px; }
    .main h2 { color: #ea4a2b; margin-bottom: 16px; }
    .main label { font-weight: bold; display: block; margin-top: 17px; }
    select, button { width: 100%; font-size: 1em; margin-top: 7px; padding: 8px; border-radius: 8px; border: 1px solid #d4d4d4; }
    button { background: #ea4a2b; color: #fff; border: none; font-weight: bold; margin-top: 22px; cursor: pointer; transition: background 0.15s;}
    button:hover { background: #d5371b; }
    .msg { margin-top: 24px; color: #d5371b; font-weight: bold; min-height: 32px;}
    .lang-sel { text-align:right; margin-bottom: 6px;}
    .lang-sel select {width:auto;}
    .redeem { margin-top:32px; text-align:center; font-size:1em;}
    .redeem a { color:#ea4a2b; text-decoration:underline; }
  </style>
</head>
<body>
  <div class="main">
    <div class="lang-sel">
      <label style="font-size:1em;font-weight:bold;" for="uiLangSel">ğŸŒ</label>
      <select id="uiLangSel"></select>
    </div>
    <h2 id="ui_title">Atomy HemoHIM Member Registration</h2>
    <label for="regionInput" id="ui_region_label">Region</label>
    <select id="regionInput"></select>
    <label for="langInput" id="ui_lang_label">Language</label>
    <select id="langInput"></select>
    <button id="submitBtn" onclick="getCodeAndRedirect()">Get Member Number</button>
    <div id="msg" class="msg"></div>
    <div class="redeem">
      <a id="redeemLink" href="https://form.jotform.com/251414756620050" target="_blank">ä½å®¿åˆ¸å…Œæ›è¡¨å–® / Redeem Voucher</a>
    </div>
  </div>
  <script>
    // 11èªè¨€æ¸…å–®
    const uiLangs = ["en","zh_tw","zh_cn","fr","de","ru","th","es","pt","fil","id"];
    // 52åœ°å€ 11èªç¿»è­¯
    const regions = [
      {en:"Australia",      zh_tw:"æ¾³æ´²",    zh_cn:"æ¾³å¤§åˆ©äºš",  fr:"Australie",     de:"Australien",     ru:"ĞĞ²ÑÑ‚Ñ€Ğ°Ğ»Ğ¸Ñ",     th:"à¸­à¸­à¸ªà¹€à¸•à¸£à¹€à¸¥à¸µà¸¢",    es:"Australia",      pt:"AustrÃ¡lia",      fil:"Australia",     id:"Australia"},
      {en:"Austria",        zh_tw:"å¥§åœ°åˆ©",  zh_cn:"å¥¥åœ°åˆ©",    fr:"Autriche",      de:"Ã–sterreich",     ru:"ĞĞ²ÑÑ‚Ñ€Ğ¸Ñ",       th:"à¸­à¸­à¸ªà¹€à¸•à¸£à¸µà¸¢",      es:"Austria",        pt:"Ãustria",        fil:"Austria",       id:"Austria"},
      {en:"Belarus",        zh_tw:"ç™½ä¿„ç¾…æ–¯", zh_cn:"ç™½ä¿„ç½—æ–¯",  fr:"BiÃ©lorussie",   de:"WeiÃŸrussland",   ru:"Ğ‘ĞµĞ»Ğ°Ñ€ÑƒÑÑŒ",      th:"à¹€à¸šà¸¥à¸²à¸£à¸¸à¸ª",        es:"Bielorrusia",    pt:"BielorrÃºssia",   fil:"Belarus",       id:"Belarus"},
      {en:"Belgium",        zh_tw:"æ¯”åˆ©æ™‚",  zh_cn:"æ¯”åˆ©æ—¶",    fr:"Belgique",      de:"Belgien",        ru:"Ğ‘ĞµĞ»ÑŒĞ³Ğ¸Ñ",       th:"à¹€à¸šà¸¥à¹€à¸¢à¸µà¸¢à¸¡",       es:"BÃ©lgica",        pt:"BÃ©lgica",        fil:"Belgium",       id:"Belgia"},
      {en:"Bulgaria",       zh_tw:"ä¿åŠ åˆ©äº", zh_cn:"ä¿åŠ åˆ©äºš",  fr:"Bulgarie",      de:"Bulgarien",      ru:"Ğ‘Ğ¾Ğ»Ğ³Ğ°Ñ€Ğ¸Ñ",      th:"à¸šà¸±à¸¥à¹à¸à¹€à¸£à¸µà¸¢",       es:"Bulgaria",       pt:"BulgÃ¡ria",       fil:"Bulgaria",      id:"Bulgaria"},
      {en:"Cambodia",       zh_tw:"æŸ¬åŸ”å¯¨",  zh_cn:"æŸ¬åŸ”å¯¨",    fr:"Cambodge",      de:"Kambodscha",     ru:"ĞšĞ°Ğ¼Ğ±Ğ¾Ğ´Ğ¶Ğ°",      th:"à¸à¸±à¸¡à¸à¸¹à¸Šà¸²",         es:"Camboya",        pt:"Camboja",        fil:"Cambodia",      id:"Kamboja"},
      {en:"Canada",         zh_tw:"åŠ æ‹¿å¤§",  zh_cn:"åŠ æ‹¿å¤§",    fr:"Canada",         de:"Kanada",         ru:"ĞšĞ°Ğ½Ğ°Ğ´Ğ°",        th:"à¹à¸„à¸™à¸²à¸”à¸²",          es:"CanadÃ¡",         pt:"CanadÃ¡",         fil:"Canada",        id:"Kanada"},
      {en:"Colombia",       zh_tw:"å“¥å€«æ¯”äº", zh_cn:"å“¥ä¼¦æ¯”äºš",  fr:"Colombie",      de:"Kolumbien",      ru:"ĞšĞ¾Ğ»ÑƒĞ¼Ğ±Ğ¸Ñ",      th:"à¹‚à¸„à¸¥à¸­à¸¡à¹€à¸šà¸µà¸¢",       es:"Colombia",       pt:"ColÃ´mbia",       fil:"Colombia",      id:"Kolombia"},
      {en:"Croatia",        zh_tw:"å…‹ç¾…åŸƒè¥¿äº", zh_cn:"å…‹ç½—åœ°äºš", fr:"Croatie",      de:"Kroatien",       ru:"Ğ¥Ğ¾Ñ€Ğ²Ğ°Ñ‚Ğ¸Ñ",      th:"à¹‚à¸„à¸£à¹€à¸­à¹€à¸Šà¸µà¸¢",       es:"Croacia",        pt:"CroÃ¡cia",        fil:"Croatia",       id:"Kroasia"},
      {en:"Cyprus",         zh_tw:"è³½æ™®å‹’æ–¯", zh_cn:"å¡æµ¦è·¯æ–¯",   fr:"Chypre",        de:"Zypern",         ru:"ĞšĞ¸Ğ¿Ñ€",          th:"à¹„à¸‹à¸›à¸£à¸±à¸ª",          es:"Chipre",         pt:"Chipre",         fil:"Cyprus",        id:"Siprus"},
      {en:"Czech Republic", zh_tw:"æ·å…‹",    zh_cn:"æ·å…‹",      fr:"RÃ©publique tchÃ¨que", de:"Tschechien", ru:"Ğ§ĞµÑ…Ğ¸Ñ",         th:"à¸ªà¸²à¸˜à¸²à¸£à¸“à¸£à¸±à¸à¹€à¸Šà¹‡à¸",   es:"RepÃºblica Checa", pt:"RepÃºblica Tcheca", fil:"Czech Republic", id:"Republik Ceko"},
      {en:"Denmark",        zh_tw:"ä¸¹éº¥",    zh_cn:"ä¸¹éº¦",      fr:"Danemark",       de:"DÃ¤nemark",       ru:"Ğ”Ğ°Ğ½Ğ¸Ñ",         th:"à¹€à¸”à¸™à¸¡à¸²à¸£à¹Œà¸",        es:"Dinamarca",      pt:"Dinamarca",      fil:"Denmark",       id:"Denmark"},
      {en:"Estonia",        zh_tw:"æ„›æ²™å°¼äº", zh_cn:"çˆ±æ²™å°¼äºš",  fr:"Estonie",       de:"Estland",        ru:"Ğ­ÑÑ‚Ğ¾Ğ½Ğ¸Ñ",       th:"à¹€à¸­à¸ªà¹‚à¸•à¹€à¸™à¸µà¸¢",       es:"Estonia",        pt:"EstÃ³nia",        fil:"Estonia",       id:"Estonia"},
      {en:"Finland",        zh_tw:"èŠ¬è˜­",    zh_cn:"èŠ¬å…°",      fr:"Finlande",       de:"Finnland",       ru:"Ğ¤Ğ¸Ğ½Ğ»ÑĞ½Ğ´Ğ¸Ñ",     th:"à¸Ÿà¸´à¸™à¹à¸¥à¸™à¸”à¹Œ",        es:"Finlandia",      pt:"FinlÃ¢ndia",      fil:"Finland",       id:"Finlandia"},
      {en:"France",         zh_tw:"æ³•åœ‹",    zh_cn:"æ³•å›½",      fr:"France",         de:"Frankreich",     ru:"Ğ¤Ñ€Ğ°Ğ½Ñ†Ğ¸Ñ",       th:"à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª",        es:"Francia",        pt:"FranÃ§a",         fil:"France",        id:"Perancis"},
      {en:"Germany",        zh_tw:"å¾·åœ‹",    zh_cn:"å¾·å›½",      fr:"Allemagne",      de:"Deutschland",    ru:"Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ",      th:"à¹€à¸¢à¸­à¸£à¸¡à¸™à¸µ",         es:"Alemania",       pt:"Alemanha",       fil:"Germany",       id:"Jerman"},
      {en:"Greece",         zh_tw:"å¸Œè‡˜",    zh_cn:"å¸Œè…Š",      fr:"GrÃ¨ce",          de:"Griechenland",   ru:"Ğ“Ñ€ĞµÑ†Ğ¸Ñ",        th:"à¸à¸£à¸µà¸‹",            es:"Grecia",         pt:"GrÃ©cia",         fil:"Greece",        id:"Yunani"},
      {en:"Hungary",        zh_tw:"åŒˆç‰™åˆ©",  zh_cn:"åŒˆç‰™åˆ©",    fr:"Hongrie",        de:"Ungarn",         ru:"Ğ’ĞµĞ½Ğ³Ñ€Ğ¸Ñ",       th:"à¸®à¸±à¸‡à¸à¸²à¸£à¸µ",          es:"HungrÃ­a",        pt:"Hungria",        fil:"Hungary",       id:"Hungaria"},
      {en:"Iceland",        zh_tw:"å†°å³¶",    zh_cn:"å†°å²›",      fr:"Islande",        de:"Island",         ru:"Ğ˜ÑĞ»Ğ°Ğ½Ğ´Ğ¸Ñ",      th:"à¹„à¸­à¸‹à¹Œà¹à¸¥à¸™à¸”à¹Œ",        es:"Islandia",       pt:"IslÃ¢ndia",       fil:"Iceland",       id:"Islandia"},
      {en:"Indonesia",      zh_tw:"å°å°¼",    zh_cn:"å°å°¼",      fr:"IndonÃ©sie",      de:"Indonesien",     ru:"Ğ˜Ğ½Ğ´Ğ¾Ğ½ĞµĞ·Ğ¸Ñ",     th:"à¸­à¸´à¸™à¹‚à¸”à¸™à¸µà¹€à¸‹à¸µà¸¢",      es:"Indonesia",      pt:"IndonÃ©sia",      fil:"Indonesia",     id:"Indonesia"},
      {en:"Ireland",        zh_tw:"æ„›çˆ¾è˜­",  zh_cn:"çˆ±å°”å…°",    fr:"Irlande",        de:"Irland",         ru:"Ğ˜Ñ€Ğ»Ğ°Ğ½Ğ´Ğ¸Ñ",      th:"à¹„à¸­à¸£à¹Œà¹à¸¥à¸™à¸”à¹Œ",         es:"Irlanda",        pt:"Irlanda",        fil:"Ireland",       id:"Irlandia"},
      {en:"Italy",          zh_tw:"ç¾©å¤§åˆ©",  zh_cn:"æ„å¤§åˆ©",    fr:"Italie",         de:"Italien",        ru:"Ğ˜Ñ‚Ğ°Ğ»Ğ¸Ñ",        th:"à¸­à¸´à¸•à¸²à¸¥à¸µ",           es:"Italia",         pt:"ItÃ¡lia",         fil:"Italy",         id:"Italia"},
      {en:"Kazakhstan",     zh_tw:"å“ˆè–©å…‹",  zh_cn:"å“ˆè¨å…‹",    fr:"Kazakhstan",     de:"Kasachstan",     ru:"ĞšĞ°Ğ·Ğ°Ñ…ÑÑ‚Ğ°Ğ½",     th:"à¸„à¸²à¸‹à¸±à¸„à¸ªà¸–à¸²à¸™",        es:"KazajistÃ¡n",     pt:"CazaquistÃ£o",    fil:"Kazakhstan",    id:"Kazakhstan"},
      {en:"Kyrgyzstan",     zh_tw:"å‰çˆ¾å‰æ–¯", zh_cn:"å‰å°”å‰æ–¯", fr:"Kirghizistan",   de:"Kirgisistan",    ru:"ĞšĞ¸Ñ€Ğ³Ğ¸Ğ·Ğ¸Ñ",      th:"à¸„à¸µà¸£à¹Œà¸à¸µà¸‹à¸ªà¸–à¸²à¸™",      es:"KirguistÃ¡n",     pt:"QuirguistÃ£o",    fil:"Kyrgyzstan",    id:"Kirgizstan"},
      {en:"Latvia",         zh_tw:"æ‹‰è„«ç¶­äº", zh_cn:"æ‹‰è„±ç»´äºš",  fr:"Lettonie",       de:"Lettland",       ru:"Ğ›Ğ°Ñ‚Ğ²Ğ¸Ñ",        th:"à¸¥à¸±à¸•à¹€à¸§à¸µà¸¢",           es:"Letonia",        pt:"LetÃ´nia",        fil:"Latvia",        id:"Latvia"},
      {en:"Liechtenstein",  zh_tw:"åˆ—æ”¯æ•¦å£«ç™»", zh_cn:"åˆ—æ”¯æ•¦å£«ç™»", fr:"Liechtenstein", de:"Liechtenstein", ru:"Ğ›Ğ¸Ñ…Ñ‚ĞµĞ½ÑˆÑ‚ĞµĞ¹Ğ½",   th:"à¸¥à¸´à¸à¹€à¸•à¸™à¸ªà¹„à¸•à¸™à¹Œ",      es:"Liechtenstein",  pt:"Liechtenstein",  fil:"Liechtenstein", id:"Liechtenstein"},
      {en:"Lithuania",      zh_tw:"ç«‹é™¶å®›",  zh_cn:"ç«‹é™¶å®›",    fr:"Lituanie",       de:"Litauen",        ru:"Ğ›Ğ¸Ñ‚Ğ²Ğ°",         th:"à¸¥à¸´à¸—à¸±à¸§à¹€à¸™à¸µà¸¢",        es:"Lituania",       pt:"LituÃ¢nia",       fil:"Lithuania",     id:"Lituania"},
      {en:"Luxembourg",     zh_tw:"ç›§æ£®å ¡",  zh_cn:"å¢æ£®å ¡",    fr:"Luxembourg",     de:"Luxemburg",      ru:"Ğ›ÑĞºÑĞµĞ¼Ğ±ÑƒÑ€Ğ³",    th:"à¸¥à¸±à¸à¹€à¸‹à¸¡à¹€à¸šà¸´à¸£à¹Œà¸",      es:"Luxemburgo",     pt:"Luxemburgo",     fil:"Luxembourg",    id:"Luksemburg"},
      {en:"Malaysia",       zh_tw:"é¦¬ä¾†è¥¿äº", zh_cn:"é©¬æ¥è¥¿äºš",  fr:"Malaisie",       de:"Malaysia",       ru:"ĞœĞ°Ğ»Ğ°Ğ¹Ğ·Ğ¸Ñ",      th:"à¸¡à¸²à¹€à¸¥à¹€à¸‹à¸µà¸¢",         es:"Malasia",        pt:"MalÃ¡sia",        fil:"Malaysia",      id:"Malaysia"},
      {en:"Malta",          zh_tw:"é¦¬è€³ä»–",  zh_cn:"é©¬è€³ä»–",    fr:"Malte",          de:"Malta",          ru:"ĞœĞ°Ğ»ÑŒÑ‚Ğ°",        th:"à¸¡à¸­à¸¥à¸•à¸²",            es:"Malta",          pt:"Malta",          fil:"Malta",         id:"Malta"},
      {en:"Mexico",         zh_tw:"å¢¨è¥¿å“¥",  zh_cn:"å¢¨è¥¿å“¥",    fr:"Mexique",        de:"Mexiko",         ru:"ĞœĞµĞºÑĞ¸ĞºĞ°",       th:"à¹€à¸¡à¹‡à¸à¸‹à¸´à¹‚à¸",         es:"MÃ©xico",         pt:"MÃ©xico",         fil:"Mexico",        id:"Meksiko"},
      {en:"Monaco",         zh_tw:"æ‘©ç´å“¥",  zh_cn:"æ‘©çº³å“¥",    fr:"Monaco",         de:"Monaco",         ru:"ĞœĞ¾Ğ½Ğ°ĞºĞ¾",        th:"à¹‚à¸¡à¸™à¸²à¹‚à¸",           es:"MÃ³naco",         pt:"MÃ´naco",         fil:"Monaco",        id:"Monako"},
      {en:"Mongolia",       zh_tw:"è’™å¤",    zh_cn:"è’™å¤",      fr:"Mongolie",       de:"Mongolei",       ru:"ĞœĞ¾Ğ½Ğ³Ğ¾Ğ»Ğ¸Ñ",      th:"à¸¡à¸­à¸‡à¹‚à¸à¹€à¸¥à¸µà¸¢",        es:"Mongolia",       pt:"MongÃ³lia",       fil:"Mongolia",      id:"Mongolia"},
      {en:"Netherlands",    zh_tw:"è·è˜­",    zh_cn:"è·å…°",      fr:"Pays-Bas",       de:"Niederlande",    ru:"ĞĞ¸Ğ´ĞµÑ€Ğ»Ğ°Ğ½Ğ´Ñ‹",    th:"à¹€à¸™à¹€à¸˜à¸­à¸£à¹Œà¹à¸¥à¸™à¸”à¹Œ",      es:"PaÃ­ses Bajos",   pt:"PaÃ­ses Baixos",  fil:"Netherlands",   id:"Belanda"},
      {en:"New Zealand",    zh_tw:"ç´è¥¿è˜­",  zh_cn:"æ–°è¥¿å…°",    fr:"Nouvelle-ZÃ©lande",de:"Neuseeland",    ru:"ĞĞ¾Ğ²Ğ°Ñ Ğ—ĞµĞ»Ğ°Ğ½Ğ´Ğ¸Ñ",th:"à¸™à¸´à¸§à¸‹à¸µà¹à¸¥à¸™à¸”à¹Œ",       es:"Nueva Zelanda",  pt:"Nova ZelÃ¢ndia",  fil:"New Zealand",   id:"Selandia Baru"},
      {en:"Norway",         zh_tw:"æŒªå¨",    zh_cn:"æŒªå¨",      fr:"NorvÃ¨ge",        de:"Norwegen",       ru:"ĞĞ¾Ñ€Ğ²ĞµĞ³Ğ¸Ñ",      th:"à¸™à¸­à¸£à¹Œà¹€à¸§à¸¢à¹Œ",         es:"Noruega",        pt:"Noruega",        fil:"Norway",        id:"Norwegia"},
      {en:"Philippines",    zh_tw:"è²å¾‹è³“",  zh_cn:"è²å¾‹å®¾",    fr:"Philippines",    de:"Philippinen",    ru:"Ğ¤Ğ¸Ğ»Ğ¸Ğ¿Ğ¿Ğ¸Ğ½Ñ‹",     th:"à¸Ÿà¸´à¸¥à¸´à¸›à¸›à¸´à¸™à¸ªà¹Œ",        es:"Filipinas",      pt:"Filipinas",      fil:"Pilipinas",     id:"Filipina"},
      {en:"Poland",         zh_tw:"æ³¢è˜­",    zh_cn:"æ³¢å…°",      fr:"Pologne",        de:"Polen",          ru:"ĞŸĞ¾Ğ»ÑŒÑˆĞ°",        th:"à¹‚à¸›à¹à¸¥à¸™à¸”à¹Œ",           es:"Polonia",        pt:"PolÃ´nia",        fil:"Poland",        id:"Polandia"},
      {en:"Portugal",       zh_tw:"è‘¡è„ç‰™",  zh_cn:"è‘¡è„ç‰™",    fr:"Portugal",       de:"Portugal",       ru:"ĞŸĞ¾Ñ€Ñ‚ÑƒĞ³Ğ°Ğ»Ğ¸Ñ",    th:"à¹‚à¸›à¸£à¸•à¸¸à¹€à¸à¸ª",          es:"Portugal",       pt:"Portugal",       fil:"Portugal",      id:"Portugal"},
      {en:"Romania",        zh_tw:"ç¾…é¦¬å°¼äº", zh_cn:"ç½—é©¬å°¼äºš",  fr:"Roumanie",       de:"RumÃ¤nien",       ru:"Ğ ÑƒĞ¼Ñ‹Ğ½Ğ¸Ñ",       th:"à¹‚à¸£à¸¡à¸²à¹€à¸™à¸µà¸¢",         es:"RumanÃ­a",        pt:"RomÃªnia",        fil:"Romania",       id:"Rumania"},
      {en:"Russia",         zh_tw:"ä¿„ç¾…æ–¯",  zh_cn:"ä¿„ç½—æ–¯",    fr:"Russie",         de:"Russland",       ru:"Ğ Ğ¾ÑÑĞ¸Ñ",        th:"à¸£à¸±à¸ªà¹€à¸‹à¸µà¸¢",           es:"Rusia",          pt:"RÃºssia",         fil:"Russia",        id:"Rusia"},
      {en:"Singapore",      zh_tw:"æ–°åŠ å¡",  zh_cn:"æ–°åŠ å¡",    fr:"Singapour",      de:"Singapur",       ru:"Ğ¡Ğ¸Ğ½Ğ³Ğ°Ğ¿ÑƒÑ€",      th:"à¸ªà¸´à¸‡à¸„à¹‚à¸›à¸£à¹Œ",          es:"Singapur",       pt:"Singapura",      fil:"Singapore",     id:"Singapura"},
      {en:"Slovakia",       zh_tw:"æ–¯æ´›ä¼å…‹", zh_cn:"æ–¯æ´›ä¼å…‹",  fr:"Slovaquie",      de:"Slowakei",       ru:"Ğ¡Ğ»Ğ¾Ğ²Ğ°ĞºĞ¸Ñ",      th:"à¸ªà¹‚à¸¥à¸§à¸²à¹€à¸à¸µà¸¢",         es:"Eslovaquia",     pt:"EslovÃ¡quia",     fil:"Slovakia",      id:"Slovakia"},
      {en:"Slovenia",       zh_tw:"æ–¯æ´›ç¶­å°¼äº", zh_cn:"æ–¯æ´›æ–‡å°¼äºš",fr:"SlovÃ©nie",    de:"Slowenien",      ru:"Ğ¡Ğ»Ğ¾Ğ²ĞµĞ½Ğ¸Ñ",      th:"à¸ªà¹‚à¸¥à¸§à¸µà¹€à¸™à¸µà¸¢",         es:"Eslovenia",      pt:"EslovÃªnia",      fil:"Slovenia",      id:"Slovenia"},
      {en:"Spain",          zh_tw:"è¥¿ç­ç‰™",  zh_cn:"è¥¿ç­ç‰™",    fr:"Espagne",        de:"Spanien",        ru:"Ğ˜ÑĞ¿Ğ°Ğ½Ğ¸Ñ",       th:"à¸ªà¹€à¸›à¸™",              es:"EspaÃ±a",         pt:"Espanha",        fil:"Spain",         id:"Spanyol"},
      {en:"Sweden",         zh_tw:"ç‘å…¸",    zh_cn:"ç‘å…¸",      fr:"SuÃ¨de",          de:"Schweden",       ru:"Ğ¨Ğ²ĞµÑ†Ğ¸Ñ",        th:"à¸ªà¸§à¸µà¹€à¸”à¸™",            es:"Suecia",         pt:"SuÃ©cia",         fil:"Sweden",        id:"Swedia"},
      {en:"Switzerland",    zh_tw:"ç‘å£«",    zh_cn:"ç‘å£«",      fr:"Suisse",         de:"Schweiz",        ru:"Ğ¨Ğ²ĞµĞ¹Ñ†Ğ°Ñ€Ğ¸Ñ",     th:"à¸ªà¸§à¸´à¸•à¹€à¸‹à¸­à¸£à¹Œà¹à¸¥à¸™à¸”à¹Œ",     es:"Suiza",          pt:"SuÃ­Ã§a",          fil:"Switzerland",   id:"Swiss"},
      {en:"Taiwan",         zh_tw:"å°ç£",    zh_cn:"å°æ¹¾",      fr:"TaÃ¯wan",         de:"Taiwan",         ru:"Ğ¢Ğ°Ğ¹Ğ²Ğ°Ğ½ÑŒ",       th:"à¹„à¸•à¹‰à¸«à¸§à¸±à¸™",           es:"TaiwÃ¡n",         pt:"Taiwan",         fil:"Taiwan",        id:"Taiwan"},
      {en:"Thailand",       zh_tw:"æ³°åœ‹",    zh_cn:"æ³°å›½",      fr:"ThaÃ¯lande",      de:"Thailand",       ru:"Ğ¢Ğ°Ğ¸Ğ»Ğ°Ğ½Ğ´",       th:"à¸›à¸£à¸°à¹€à¸—à¸¨à¹„à¸—à¸¢",          es:"Tailandia",      pt:"TailÃ¢ndia",      fil:"Thailand",      id:"Thailand"},
      {en:"United Kingdom", zh_tw:"è‹±åœ‹",    zh_cn:"è‹±å›½",      fr:"Royaume-Uni",    de:"Vereinigtes KÃ¶nigreich", ru:"Ğ’ĞµĞ»Ğ¸ĞºĞ¾Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ", th:"à¸ªà¸«à¸£à¸²à¸Šà¸­à¸²à¸“à¸²à¸ˆà¸±à¸à¸£", es:"Reino Unido", pt:"Reino Unido", fil:"United Kingdom", id:"Inggris Raya"},
      {en:"United States",  zh_tw:"ç¾åœ‹",    zh_cn:"ç¾å›½",      fr:"Ã‰tats-Unis",     de:"Vereinigte Staaten",     ru:"Ğ¡Ğ¨Ğ",          th:"à¸ªà¸«à¸£à¸±à¸à¸­à¹€à¸¡à¸£à¸´à¸à¸²",      es:"Estados Unidos", pt:"Estados Unidos", fil:"United States", id:"Amerika Serikat"},
      {en:"Uzbekistan",     zh_tw:"çƒèŒ²åˆ¥å…‹", zh_cn:"ä¹Œå…¹åˆ«å…‹",  fr:"OuzbÃ©kistan",    de:"Usbekistan",     ru:"Ğ£Ğ·Ğ±ĞµĞºĞ¸ÑÑ‚Ğ°Ğ½",     th:"à¸­à¸¸à¸‹à¹€à¸šà¸à¸´à¸ªà¸–à¸²à¸™",        es:"UzbekistÃ¡n",     pt:"UzbequistÃ£o",    fil:"Uzbekistan",    id:"Uzbekistan"}
    ];

    // å„èªè¨€ç”¨è©
    const texts = {
      title: {
        en: "Atomy HemoHIM Member Registration",
        zh_tw: "Atomy HemoHIM æœƒå“¡ç”³è«‹",
        zh_cn: "Atomy HemoHIM ä¼šå‘˜ç”³è¯·",
        fr: "Inscription Membre Atomy HemoHIM",
        de: "Atomy HemoHIM Mitgliedsanmeldung",
        ru: "Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ° Atomy HemoHIM",
        th: "à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸ªà¸¡à¸²à¸Šà¸´à¸ Atomy HemoHIM",
        es: "Registro de Miembro Atomy HemoHIM",
        pt: "Cadastro de Membro Atomy HemoHIM",
        fil: "Atomy HemoHIM Pagpaparehistro",
        id: "Pendaftaran Anggota Atomy HemoHIM"
      },
      region: {
        en: "Region", zh_tw:"åœ°å€", zh_cn:"åœ°åŒº", fr:"RÃ©gion", de:"Region", ru:"Ğ ĞµĞ³Ğ¸Ğ¾Ğ½", th:"à¸ à¸¹à¸¡à¸´à¸ à¸²à¸„", es:"RegiÃ³n", pt:"RegiÃ£o", fil:"Rehiyon", id:"Wilayah"
      },
      language: {
        en: "Language", zh_tw:"èªè¨€", zh_cn:"è¯­è¨€", fr:"Langue", de:"Sprache", ru:"Ğ¯Ğ·Ñ‹Ğº", th:"à¸ à¸²à¸©à¸²", es:"Idioma", pt:"Idioma", fil:"Wika", id:"Bahasa"
      },
      btn: {
        en:"Get Member Number", zh_tw:"é ˜å–æœƒå“¡ç·¨è™Ÿ", zh_cn:"é¢†å–ä¼šå‘˜ç¼–å·", fr:"Obtenir le numÃ©ro de membre", de:"Mitgliedsnummer erhalten", ru:"ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°", th:"à¸£à¸±à¸šà¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸ªà¸¡à¸²à¸Šà¸´à¸", es:"Obtener nÃºmero de miembro", pt:"Obter nÃºmero de membro", fil:"Kunin ang Member Number", id:"Dapatkan Nomor Member"
      },
      redeem: {
        en:"Redeem Voucher", zh_tw:"å…Œæ›ä½å®¿åˆ¸", zh_cn:"å…‘æ¢ä½å®¿åˆ¸", fr:"Ã‰changer le bon", de:"Gutschein einlÃ¶sen", ru:"ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ°ÑƒÑ‡ĞµÑ€", th:"à¹à¸¥à¸à¸£à¸±à¸šà¸šà¸±à¸•à¸£à¸à¸³à¸™à¸±à¸¥", es:"Canjear cupÃ³n", pt:"Resgatar voucher", fil:"I-redeem ang Voucher", id:"Tukar Voucher"
      },
      msg_choose: {
        en:"Please select region and language.", zh_tw:"è«‹é¸æ“‡åœ°å€èˆ‡èªè¨€", zh_cn:"è¯·é€‰æ‹©åœ°åŒºä¸è¯­è¨€", fr:"Veuillez choisir une rÃ©gion et une langue.", de:"Bitte wÃ¤hlen Sie Region und Sprache.", ru:"ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½ Ğ¸ ÑĞ·Ñ‹Ğº.", th:"à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸ à¸¹à¸¡à¸´à¸ à¸²à¸„à¹à¸¥à¸°à¸ à¸²à¸©à¸²", es:"Por favor seleccione regiÃ³n e idioma.", pt:"Por favor, selecione regiÃ£o e idioma.", fil:"Pumili ng rehiyon at wika.", id:"Silakan pilih wilayah dan bahasa."
      },
      msg_wait: {
        en:"Please wait...", zh_tw:"è«‹ç¨å€™...", zh_cn:"è¯·ç¨å€™...", fr:"Veuillez patienter...", de:"Bitte warten...", ru:"ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ...", th:"à¸à¸£à¸¸à¸“à¸²à¸£à¸­à¸ªà¸±à¸à¸„à¸£à¸¹à¹ˆ...", es:"Por favor espere...", pt:"Por favor, aguarde...", fil:"Pakiusap maghintay...", id:"Mohon tunggu..."
      },
      msg_fail: {
        en:"API connection failed, please try again.", zh_tw:"API é€£ç·šå¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚", zh_cn:"API è¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚", fr:"Ã‰chec de connexion Ã  l'API, veuillez rÃ©essayer.", de:"API-Verbindung fehlgeschlagen, bitte versuchen Sie es erneut.", ru:"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº API, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.", th:"à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ API à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ", es:"La conexiÃ³n API fallÃ³, intente nuevamente.", pt:"A conexÃ£o com a API falhou, tente novamente.", fil:"Nabigo ang koneksyon sa API, pakisubukang muli.", id:"Koneksi API gagal, silakan coba lagi."
      },
      msg_error: {
        en:"Registration failed: ", zh_tw:"ç”³è«‹å¤±æ•—ï¼š", zh_cn:"ç”³è¯·å¤±è´¥ï¼š", fr:"Ã‰chec de l'inscription : ", de:"Registrierung fehlgeschlagen: ", ru:"ĞÑˆĞ¸Ğ±ĞºĞ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸: ", th:"à¸ªà¸¡à¸±à¸„à¸£à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ", es:"Registro fallido: ", pt:"Falha no cadastro: ", fil:"Nabigo ang pagrerehistro: ", id:"Pendaftaran gagal: "
      }
    };

    // èªè¨€/åœ°å€ä¸‹æ‹‰å¼
    const uiLangSel = document.getElementById('uiLangSel');
    const regionSel = document.getElementById('regionInput');
    const langSel = document.getElementById('langInput');
    const msgDiv = document.getElementById('msg');
    const titleH2 = document.getElementById('ui_title');
    const regionLabel = document.getElementById('ui_region_label');
    const langLabel = document.getElementById('ui_lang_label');
    const submitBtn = document.getElementById('submitBtn');
    const redeemLink = document.getElementById('redeemLink');

    // Jotformå¤šèªï¼ˆç”¨æ–¼å¸¶å…¥è¡¨å–®èªè¨€åƒæ•¸ï¼‰
    const jotformLangMap = {
      en:"en", zh_tw:"zh-TW", zh_cn:"zh-CN", fr:"fr", de:"de", ru:"ru", th:"th", es:"es", pt:"pt", fil:"fil", id:"id"
    };

    // å–å¾—ç€è¦½å™¨èªè¨€é è¨­
    function guessLang() {
      const n = navigator.language || navigator.userLanguage || 'en';
      if(n.startsWith('zh-TW')||n.startsWith('zh-HK')) return "zh_tw";
      if(n.startsWith('zh')) return "zh_cn";
      if(n.startsWith('fr')) return "fr";
      if(n.startsWith('de')) return "de";
      if(n.startsWith('ru')) return "ru";
      if(n.startsWith('th')) return "th";
      if(n.startsWith('es')) return "es";
      if(n.startsWith('pt')) return "pt";
      if(n.startsWith('fil')||n.startsWith('tl')) return "fil";
      if(n.startsWith('id')) return "id";
      return "en";
    }

    // åˆå§‹åŒ–èªè¨€èˆ‡åœ°å€é¸å–®
    function setLangUi(lang) {
      // æ¨™é¡Œã€æŒ‰éˆ•
      titleH2.textContent = texts.title[lang]||texts.title.en;
      regionLabel.textContent = texts.region[lang]||texts.region.en;
      langLabel.textContent = texts.language[lang]||texts.language.en;
      submitBtn.textContent = texts.btn[lang]||texts.btn.en;
      redeemLink.textContent = (texts.redeem[lang]||texts.redeem.en) + " / Redeem Voucher";
      // åœ°å€ä¸‹æ‹‰
      regionSel.innerHTML = `<option value="">--${texts.region[lang]||texts.region.en}--</option>`;
      regions.forEach(r => {
        regionSel.innerHTML += `<option value="${r.en}">${r[lang]||r.en}</option>`;
      });
      // è¡¨å–®èªè¨€é¸å–®
      langSel.innerHTML = '';
      uiLangs.forEach(l => {
        langSel.innerHTML += `<option value="${l}" ${l===lang?'selected':''}>${texts.language[l]}</option>`;
      });
      // é è¨­èªè¨€é¸å–®
      uiLangSel.innerHTML = '';
      uiLangs.forEach(l => {
        uiLangSel.innerHTML += `<option value="${l}" ${l===lang?'selected':''}>${texts.language[l]}</option>`;
      });
    }

    // é é¢è¼‰å…¥ï¼šè‡ªå‹•åˆ‡æ›èªè¨€
    let uiLang = guessLang();
    setLangUi(uiLang);

    uiLangSel.onchange = function() {
      uiLang = uiLangSel.value;
      setLangUi(uiLang);
      msgDiv.textContent = "";
    };
    langSel.onchange = function() {
      uiLang = langSel.value;
      setLangUi(uiLang);
      msgDiv.textContent = "";
    };

    // é€å‡ºè¡¨å–®ï¼ŒAPI é€£ç·šé˜²å‘†
    async function getCodeAndRedirect() {
      msgDiv.textContent = "";
      const region = regionSel.value;
      const lang = langSel.value;
      if(!region || !lang){
        msgDiv.textContent = texts.msg_choose[uiLang];
        return;
      }
      msgDiv.textContent = texts.msg_wait[uiLang];

      try {
        // 10ç§’é€¾æ™‚
        const resp = await Promise.race([
          fetch('https://script.google.com/macros/s/AKfycbwatarqL8yQzmQpX9UBqxpiFs5RuqfvFgI7tOfqJKequkRs6SJ0tm2ayLRc9ur-oOYQ/exec', {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ action: "register", region: region, lang: lang })
          }),
          new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')), 10000))
        ]);
        if(!resp || !resp.ok){
          throw new Error("API Response Error");
        }
        const data = await resp.json();
        if(data.error){
          msgDiv.textContent = texts.msg_error[uiLang] + (data.error||"");
          return;
        }
        // çµ„æˆ JotForm é å¡«ç¶²å€
        const jotformUrl = `https://form.jotform.com/251412432618046?member_number=${encodeURIComponent(data.member_number)}&password=${encodeURIComponent(data.password)}&website=${encodeURIComponent(data.official_website)}&lang=${encodeURIComponent(jotformLangMap[lang]||'en')}`;
        window.location.href = jotformUrl;
      }catch(e){
        msgDiv.textContent = texts.msg_fail[uiLang];
      }
    }
  </script>
</body>
</html>
